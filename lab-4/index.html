<!DOCTYPE html>
<html>
<head>
	<title>Color Game - Multimedia Programming 2563 ITKMITL</title>
	<link rel="stylesheet" type="text/css" href="../src/reset.css">
	<link rel="stylesheet" type="text/css" href="lab.css">
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>
<body>
	<div id="canvas">
		<section id="canvas_header">
			<div>
				เหลือเวลา {{time}} วินาที   <!--  เปลี่ยน ให้ตรงตาม js//-->
			</div>
		</section>
		<section id="canvas_main">
			<main>
				<a-dot v-for="i in row*row"

				:style="{

				'--row': row,
				'--h': h,
				'--l': l+'%',		
			}"
				:data-pick="i == pick"
				@click="check(i == pick)"
				></a-dot>
	
			</main>
		</section>
		<section id="canvas_footer">
			<div>
				คุณได้ {{score}} คะแนน
			</div>
		</section>
	</div>

	<script>
		let picklight = "25%"
		document.registerElement('a-dot') //ให้ vue รู้จัก a-dot

		function rand(start,stop){//สร้างฟังก์ชัน random ไว้ใช้
			let shift = (stop-start)+1
			return Math.floor(Math.random()*100%shift)+start
		}
		function co(start,stop){//สร้างฟังก์ชัน random ไว้ใช้
			let shift = start + stop -5
			return Math.floor(Math.random()*100%shift)+start
		}

		let app = new Vue({
			el:'#canvas',
			data:{
				row:2, //จำนวนแถวที่จะมีในรอบนี้
				h:220, // hue ในรอบนี้ ค่าเริ่มต้น
				time:30, //เวลาเริ่มต้น
				score:0, //คะแนนเริ่มต้น
				pick:1, //หมายเลขวงกลมที่จะสีแตกต่างจากก้อนอื่นๆ
				l:50,//ความสว่างของสีทั่วไปในรอบนี้
			},
			methods: { 
				check: function(e){
					if(this.time > 0){
						console.log(e)
						//ทำให้เช็คก้อรว่าถูกมั้ย
						if(e == true){
							this.correct()
							this.l--
						}
						else{
							this.incorrect()
						}
					}
					

				},
			correct : function(){
					this.score+=1
					this.row=rand(3,12)
					this.h=co(150,359)
					this.pick=rand(1,this.row*this.row)
					
					console.log('Correct!')
				},
				incorrect: function(){
					this.score-=1
					this.time-=2
					this.h=co(150,359)
					this.pick=rand(1,this.row*this.row)
					console.log('incorrect')
				}

			}
		})
		//ทำให้แคนวาสมี --picklight ตามที่กำหนดไว้ข้างบนนี้
		document.querySelector('#canvas').style.setProperty('--picklight',picklight);
		
		let counter = setInterval(()=>{
			if (app.time>0) {
				app.time--
			}else{
				clearInterval(counter)
			}
		},1000);
	</script>
</body>
</html>